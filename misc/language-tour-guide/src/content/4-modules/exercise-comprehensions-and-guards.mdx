export const frontmatter = {order: 20}

# Exercise: Comprehensions and Guards

Practice using comprehensions with filters and pattern matching!

## Your Task

Create a `StudentGrades` module that processes student records:

1. Calculate grade statistics using comprehensions
2. Filter students based on various criteria
3. Transform data into different formats
4. Use guards to validate data

## Requirements

- Calculate class average
- Find all passing students (grade >= 60)
- Find honor roll students (grade >= 85)
- Convert numeric grades to letter grades
- Group students by grade category

export const defaultCode = `defmodule StudentGrades do

  # Sample data structure: %{name: "Alice", grade: 85, subject: "Math"}
  def process_grades(students) do
    %{
      class_average: calculate_average(students),
      passing_students: find_passing(students),
      honor_roll: find_honor_roll(students),
      letter_grades: assign_letter_grades(students),
      grade_distribution: group_by_grade(students)
    }
  end

  # TODO: Calculate average using comprehension
  defp calculate_average(students) do 
    # Hint: Use a comprehension to extract grades, then calculate average 
    # Return 0 if empty list
    0
  end

  # TODO: Find passing students (grade >= 60)
  defp find_passing(students) do # Use comprehension with filter
    []
  end

  # TODO: Find honor roll students (grade >= 85)
  defp find_honor_roll(students) do # Return list of student names only
    []
  end

  # TODO: Convert to letter grades
  defp assign*letter_grades(students) do 
    # Use comprehension to transform each student
    # Add letter_grade field based on numeric grade 
    # A: 90-100, B: 80-89, C: 70-79, D: 60-69, F: < 60

    Map.put(student, :letter_grade, letter)
  end

  # TODO: Group students by grade category
  defp group_by_grade(students) do # Return map with keys: :excellent, :good, :average, :failing # excellent: >= 90, good: 80-89, average: 60-79, failing: < 60
    %{
      excellent: [], # TODO: Filter students
      good: [], # TODO: Filter students
      average: [], # TODO: Filter students  
      failing: [] # TODO: Filter students
    }
  end
end

# Test data

students = [
%{name: "Alice", grade: 92, subject: "Math"},
%{name: "Bob", grade: 78, subject: "Math"},
%{name: "Charlie", grade: 85, subject: "Math"},
%{name: "Diana", grade: 58, subject: "Math"},
%{name: "Eve", grade: 95, subject: "Math"},
%{name: "Frank", grade: 67, subject: "Math"}
]

result = StudentGrades.process_grades(students)
IO.inspect(result, pretty: true)`
