export const frontmatter = {order: 22}

# Final Exercise: Build a Todo List Manager

Put it all together by building a functional todo list manager!

## Your Task

Create a complete `TodoList` module that manages tasks with the following features:

1. Add tasks with priorities (:high, :medium, :low)
2. Mark tasks as complete
3. List tasks (all, completed, pending)
4. Filter tasks by priority
5. Get statistics about the tasks

## Data Structure

Each task should be a map: `%{id: 1, title: "Task", priority: :high, completed: false}`

## Bonus Challenges

- Add due dates and sort by them
- Implement task search
- Add tags and filter by them

export const defaultCode = `defmodule TodoList do

  # Initialize with empty list or starter tasks
  def new(), do: []
  def new(initial_tasks) when is_list(initial_tasks), do: initial_tasks

  # TODO: Add a new task
  # Should auto-generate an ID based on list length + 1
  def add_task(todos, title, priority \\\\ :medium) when priority in [:high, :medium, :low] do
    new_task = %{
      id: 0, # TODO: Generate proper ID
      title: title,
      priority: priority,
      completed: false
    } # TODO: Add to list
  end

  # TODO: Mark task as complete by ID
  def complete_task(todos, task_id) do 
    # Hint: Use Enum.map and pattern matching
    # If task with ID exists, set completed: true
    todos
  end

  # TODO: List all tasks
  def list_all(todos), do: todos

  # TODO: List only completed tasks
  def list_completed(todos) do # Use Enum.filter or comprehension
    []
  end

  # TODO: List only pending tasks
  def list_pending(todos) do
    []
  end

  # TODO: Filter by priority
  def filter_by_priority(todos, priority) when priority in [:high, :medium, :low] do
    []
  end

  # TODO: Get statistics
  def get_stats(todos) do # Return a map with: # - total: total number of tasks # - completed: number of completed tasks # - pending: number of pending tasks # - by_priority: map with count for each priority
    %{
      total: 0,
      completed: 0,
      pending: 0,
      by_priority: %{
        high: 0,
        medium: 0,
        low: 0
        }
    }
  end

  # TODO: Sort tasks by priority (high first)
  def sort_by_priority(todos) do # Hint: Create a priority_value helper function # high = 3, medium = 2, low = 1
    todos
  end

  # Helper function for priority values
  defp priority_value(:high), do: 3
  defp priority_value(:medium), do: 2
  defp priority_value(:low), do: 1

  # BONUS: Add due dates and overdue checking
  # def add_task_with_due_date(todos, title, priority, due_date) do
  # end

  # def list_overdue(todos) do
  # end

end

# Test your implementation

todos = TodoList.new()
|> TodoList.add_task("Learn Elixir basics", :high)
|> TodoList.add_task("Build a Phoenix app", :medium)
|> TodoList.add_task("Deploy to production", :low)
|> TodoList.add_task("Write tests", :high)
|> TodoList.complete_task(1)

IO.puts("All tasks:")
IO.inspect(TodoList.list_all(todos))

IO.puts("\nCompleted tasks:")
IO.inspect(TodoList.list_completed(todos))

IO.puts("\nHigh priority tasks:")
IO.inspect(TodoList.filter_by_priority(todos, :high))

IO.puts("\nStatistics:")
IO.inspect(TodoList.get_stats(todos))

IO.puts("\nSorted by priority:")
IO.inspect(TodoList.sort_by_priority(todos))`
